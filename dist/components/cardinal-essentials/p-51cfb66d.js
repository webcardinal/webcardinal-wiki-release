import{g as t}from"./p-8419ec55.js";function n(t,n,e=!1,o=null){const s=new CustomEvent(t,n);e&&(o?o.dispatchEvent(s):document.dispatchEvent(s))}function e(t,n,e){let o=null;for(;t;){if(t.matches(n)){o=t;break}if(e&&t.matches(e))break;t=t.parentElement}return o}function o(t){let n=t.replace(/[^A-Za-z0-9_-]/g,"-").toLowerCase();return n=n.replace(/(-+){2}/gm,"-"),n=n.replace(/(-+)$/gm,""),n}function s(t,n){const e=o(t),s=n.querySelector("#"+e);if(!s)return;s.scrollIntoView();let i=window.location.href,r="?";-1!==i.indexOf("chapter=")?(i=window.location.href.split("chapter=")[0],i.length>0&&(r=i[i.length-1],i=i.substring(0,i.length-1))):r=i.indexOf("?")>0?"&":"?",window.history.pushState({},"",`${i}${r+"chapter="}${e}`)}function i(t){return t&&"string"==typeof t&&0!==t.length?t.split("").map((t=>t===t.toLowerCase()?t:"-"+t.toLowerCase())).join(""):""}function r(t){return t&&"string"==typeof t&&0!==t.length?t.split("-").map(((t,n)=>0===n?t:t.charAt(0).toUpperCase()+t.slice(1))).join(""):""}function c(t){if("string"!=typeof t)throw new Error("Invalid model chain");return t.split("@").join("")}function l(t){if("boolean"==typeof t)return t;if("string"==typeof t)switch(t.toLowerCase().trim()){case"true":case"1":return!0;case"false":case"0":case null:return!1;default:return Boolean(t)}return Boolean(t)}function a(t){return t.replace(/-([a-z])/g,(function(t){return t[1].toUpperCase()}))}function u(n){const e=t(n);if(!e.innerHTML)return null;let o=e.querySelector("style");if(o){let t=e.innerHTML.replace(o.outerHTML,"");return e.innerHTML=o.outerHTML,t}return e.innerHTML}function w(t,n){const e=document.createElement("style");e.innerHTML=n,t.appendChild(e)}window.cardinal=window.cardinal||{},window.cardinal.oldCustomTheme=window.cardinal.oldCustomTheme||{};const{oldCustomTheme:d}=window.cardinal;d.dependencies=d.dependencies||{},d.imports=d.imports||{},d.appTheme=d.appTheme||null;const{dependencies:f,imports:m}=d,b=/@import.*?["']([^"']+)["'].*?;/g;function p(t){return new Promise(((n,e)=>{fetch(t).then((t=>{if(t.ok)return n(t.text());e({url:t.url,status:t.status,statusText:t.statusText})}))}))}function h(t,n){return!!n&&(n.shadowRoot?t.parentNode===n.shadowRoot.host:h(n,n.parentElement))}function g(){let n=t=>{let n={};t.addEventListener("styleExists",(e=>{e.stopImmediatePropagation(),e.preventDefault();let o=e.detail.componentTag;(0,e.detail.callback)(void 0,n.hasOwnProperty(o),t),n[o]||(n[o]=!0)})),t.addEventListener("componentWasRemoved",(t=>{let e=t.detail.componentTag;n[e]&&delete n[e]}))};return n(document.querySelector("body")),e=>{const{componentWillLoad:o,disconnectedCallback:s}=e;e.componentWillLoad=function(){const e=t(this);if(e&&e.isConnected){let t=t=>{let s="";window&&(window.basePath?s=window.basePath:window.WebCardinal&&window.WebCardinal.basePath&&(s=window.WebCardinal.basePath));let i=e.tagName.toLowerCase(),r=n=>new Promise((e=>{let r=s+"/themes/"+t+"/components/"+i+"/"+i+".css";f[r]||(f[r]=new Promise(((t,n)=>{p(r).then((n=>{t(n)})).catch(n)}))),f[r].then((t=>{var e,o;(e=r,o=t,m[e]||(m[e]=new Promise(((t,n)=>{b.exec(o)?o.replace(b,((e,s)=>{f[s]||(f[s]=p(s)),f[s].then((n=>{t(o.replace(e,n))})).catch(n)})):t(o)}))),m[e]).then((t=>{let e=document.createElement("style");e.innerHTML=t,n.append(e)}))})).catch((t=>{console.log(`Request on resource ${t.url} ended with status: ${t.status} (${t.statusText})`)})).finally((()=>{e(o&&o.call(this))}))}));return e.shadowRoot?(n(e),r(e.shadowRoot)):new Promise(e.isConnected?t=>{let n=h(e,e.parentElement);e.isSlotted=n;let s=new CustomEvent("styleExists",{bubbles:!0,cancelable:!0,composed:!0,detail:{callback:(e,s,i)=>{e?console.log(e):s?t(o&&o.call(this)):(n||(i=i.shadowRoot),r(i).then((()=>{t()})))},componentTag:n?"SLOTTED:"+i:i}});e.dispatchEvent(s)}:t=>{t(o&&o.call(this))})};return d.appTheme?t(d.appTheme):new Promise((n=>{let o=new CustomEvent("getThemeConfig",{bubbles:!0,cancelable:!0,composed:!0,detail:(e,o)=>{if(e)return console.log(e);d.appTheme=o,t(d.appTheme).then((()=>{n()}))}});e.dispatchEvent(o)}))}return o&&o.call(this)},e.disconnectedCallback=function(){const n=t(this);let e=n.tagName.toLowerCase();n.isSlotted&&(e="SLOTTED:"+e);let o=new CustomEvent("componentWasRemoved",{bubbles:!0,cancelable:!0,composed:!0,detail:{componentTag:e}});n.dispatchEvent(o),s&&s.call(this)}}}window.cardinal=window.cardinal||{},window.cardinal.customTheme=window.cardinal.customTheme||{THEME:void 0,IMPORTS:{},EVENTS:{GET_THEME:"getThemeConfig",ADD_STYLE:"CustomTheme:add-style",REMOVE_STYLE:"CustomTheme:remove-style"}};const y=window.cardinal.customTheme;async function E(t){let n="";window&&(window.basePath?n=window.basePath:window.WebCardinal&&window.WebCardinal.basePath&&(n=window.WebCardinal.basePath));const e=t.tagName.toLowerCase(),o=t.mode||t.getAttribute("mode")||"default",s=`${n}/themes/${y.THEME}/components/${e}/${e+("default"!==o?"."+o:"")+".css"}`;if(!y.IMPORTS[s]){const[t,n]=await async function(t){try{const n=await function(t,n=null){let e=window.$$;return e&&e.SSAPP_CONTEXT&&e.SSAPP_CONTEXT.BASE_URL&&e.SSAPP_CONTEXT.SEED&&0!==t.indexOf(e.SSAPP_CONTEXT.BASE_URL)&&0!==t.indexOf("data:image")&&(t=`${e.SSAPP_CONTEXT.BASE_URL}${0===t.indexOf("/")?t.substr(1):t}`),fetch(t,n)}(t);return[!0,await n.text()]}catch(t){return console.log(t),[!1]}}(s);if(!t)return;y.IMPORTS[s]=n}const i=y.IMPORTS[s];t.shadowRoot?(function(t){const n=t.host,e={true:{},false:{}};n.addEventListener(y.EVENTS.ADD_STYLE,(o=>{o.preventDefault(),o.stopImmediatePropagation();const{data:{tag:s,slotted:i},callback:r}=o.detail;e[i][s]||(r(void 0,i?{target:n}:{target:t}),e[i][s]=!0)})),n.addEventListener(y.EVENTS.REMOVE_STYLE,(t=>{t.preventDefault(),t.stopImmediatePropagation();const{data:{tag:n,slotted:o}}=t.detail;e[o][n]=!1}))}(t.shadowRoot),w(t.shadowRoot,i)):(t.isSlotted=function(t){for(;t.parentElement;){if(t.parentElement.shadowRoot)return t.parentElement.shadowRoot.host===t.parentNode;t=t.parentElement}return!1}(t),t.dispatchEvent(new CustomEvent(y.EVENTS.ADD_STYLE,{bubbles:!0,cancelable:!0,composed:!0,detail:{data:{tag:e,slotted:t.isSlotted},callback:async(t,n)=>{if(t)return console.log(t);const{target:e}=n;w(e,i)}}})))}function C(){return n=>{const{componentWillLoad:e,disconnectedCallback:o}=n;n.componentWillLoad=async function(){const n=t(this);return(n||n.isConnected)&&(y.THEME?await E(n):await async function(t,n){t.dispatchEvent(new CustomEvent(y.EVENTS.GET_THEME,{bubbles:!0,cancelable:!0,composed:!0,detail:async(e,o)=>{if(e)return console.log(e);y.THEME=o,await n(t)}}))}(n,E)),e&&e.call(this)},n.disconnectedCallback=async function(){const n=t(this);return n.dispatchEvent(new CustomEvent(y.EVENTS.REMOVE_STYLE,{bubbles:!0,cancelable:!0,composed:!0,detail:{data:{tag:n.tagName.toLowerCase(),slotted:!!n.isSlotted}}})),o&&o.call(this)}}}window.cardinal=window.cardinal||{},window.cardinal.controllers=window.cardinal.controllers||{},window.cardinal.pendingControllerRequests=window.cardinal.pendingControllerRequests||{};const{controllers:T,pendingControllerRequests:$}=window.cardinal,v={registerController:(t,n)=>{if(T[t]=n,$[t])for(;$[t].length;)$[t].pop().resolve(T[t])},getController:async(t,n=!1)=>{const e=window.WebCardinal;if(e){if(!0===n&&"ContainerController"===t&&(t="WebcController"),"object"==typeof e.controllers){const{controllers:n}=e;if(n[t])return n[t]}if("string"==typeof e.basePath){const{basePath:n}=window.WebCardinal;try{let e=await import(`${n}/scripts/controllers/${t}.js`);return e.default||e}catch(t){return console.error(t),null}}}if(T[t])return T[t];let o=`scripts/controllers/${t}.js`;if(n&&(o=`cardinal/base/controllers/${t}.js`),void 0!==window.basePath){let t="/"===window.basePath[window.basePath.length-1]?"":"/";o=window.basePath+t+o}try{let t=await import(o);return t.default||t}catch(t){return console.error(t),null}}};export{g as C,C as a,c as b,n as c,a as d,v as e,r as f,u as g,s as h,e as i,o as j,i as n,l as s}